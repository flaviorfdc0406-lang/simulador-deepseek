
---

## ðŸ“„ **2. simulador-financiamento.php** (Arquivo Principal)

```php
<?php
/**
 * Plugin Name: Simulador de Financiamento Living & Vivaz
 * Plugin URI: https://github.com/seu-usuario/simulador-financiamento-living
 * Description: Simulador completo de financiamento imobiliÃ¡rio para Living & Vivaz
 * Version: 1.0.0
 * Author: Ferreira Costa
 * Author URI: https://livingvivaz.com.br
 * License: GPL v2 or later
 * Text Domain: simulador-living
 * Requires at least: 5.0
 * Requires PHP: 7.4
 */

// Prevenir acesso direto
if (!defined('ABSPATH')) {
    exit;
}

// Constantes do plugin
define('SIMULADOR_PLUGIN_VERSION', '1.0.0');
define('SIMULADOR_PLUGIN_URL', plugin_dir_url(__FILE__));
define('SIMULADOR_PLUGIN_PATH', plugin_dir_path(__FILE__));
define('SIMULADOR_PLUGIN_FILE', __FILE__);

// Classe principal do plugin
class SimuladorFinanciamentoLiving {
    
    private static $instance = null;
    
    public static function get_instance() {
        if (null === self::$instance) {
            self::$instance = new self();
        }
        return self::$instance;
    }
    
    public function __construct() {
        add_action('init', array($this, 'init'));
        register_activation_hook(__FILE__, array($this, 'activate'));
        register_deactivation_hook(__FILE__, array($this, 'deactivate'));
    }
    
    public function init() {
        $this->load_dependencies();
        $this->init_components();
        $this->register_shortcodes();
    }
    
    private function load_dependencies() {
        $files = array(
            'class-database',
            'class-calculator',
            'class-admin-dashboard',
            'class-pdf-generator',
            'class-email-sender',
            'class-pdf-handlers',
            'class-ajax-handlers',
            'class-shortcodes'
        );
        
        foreach ($files as $file) {
            require_once SIMULADOR_PLUGIN_PATH . "includes/{$file}.php";
        }
    }
    
    private function init_components() {
        SimuladorDatabase::get_instance();
        SimuladorAdminDashboard::get_instance();
        SimuladorShortcodes::get_instance();
        SimuladorAjaxHandlers::get_instance();
        SimuladorPDFHandlers::get_instance();
        
        // Inicializar apenas no admin
        if (is_admin()) {
            // JÃ¡ inicializado acima
        }
    }
    
    private function register_shortcodes() {
        add_shortcode('simulador_financiamento', array($this, 'render_simulador'));
        add_shortcode('simulador_resultados', array($this, 'render_resultados'));
    }
    
    public function render_simulador($atts = array()) {
        wp_enqueue_script('simulador-frontend-js');
        wp_enqueue_style('simulador-css');
        
        ob_start();
        include SIMULADOR_PLUGIN_PATH . 'public/templates/formulario-simulacao.php';
        return ob_get_clean();
    }
    
    public function render_resultados($atts = array()) {
        // Shortcode para exibir apenas resultados
        return '<div id="simulador-resultados"></div>';
    }
    
    public function activate() {
        $database = SimuladorDatabase::get_instance();
        $database->create_tables();
        $database->insert_default_data();
        
        // Agendar tarefas cron se necessÃ¡rio
        if (!wp_next_scheduled('simulador_daily_cleanup')) {
            wp_schedule_event(time(), 'daily', 'simulador_daily_cleanup');
        }
    }
    
    public function deactivate() {
        // Limpar tarefas cron
        wp_clear_scheduled_hook('simulador_daily_cleanup');
    }
}

// Inicializar o plugin
function simulador_financiamento_init() {
    return SimuladorFinanciamentoLiving::get_instance();
}
add_action('plugins_loaded', 'simulador_financiamento_init');

// Hook de desinstalaÃ§Ã£o
register_uninstall_hook(__FILE__, 'simulador_financiamento_uninstall');
function simulador_financiamento_uninstall() {
    // Limpar opÃ§Ãµes e tabelas se necessÃ¡rio
    delete_option('simulador_configuracoes');
    delete_option('simulador_personalizacao');
}
?>
